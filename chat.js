let currentChat = null;
const chatData = {};

// ==================== NYASHHELP ====================
const nyashHelpResponses = {
  "—Ç–µ–º–∞": "–ß—Ç–æ–±—ã —Å–º–µ–Ω–∏—Ç—å —Ç–µ–º—É ‚Äî –∑–∞–π–¥–∏ –≤ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –¢–µ–º–∞ –∏ –≤—ã–±–µ—Ä–∏ –ª—é–±—É—é! ü©∑",
  "—à—Ä–∏—Ñ—Ç": "–®—Ä–∏—Ñ—Ç—ã –º–µ–Ω—è—é—Ç—Å—è –≤ –ù–∞—Å—Ç—Ä–æ–π–∫–∞—Ö ‚Üí –®—Ä–∏—Ñ—Ç. –°–∞–º—ã–µ –º–∏–ª—ã–µ ‚Äî Cozy –∏ Rounded~",
  "–∞–≤–∞—Ç–∞—Ä": "–ó–∞–≥—Ä—É–∑–∏ –∞–≤–∞—Ç–∞—Ä–∫—É –≤ –ù–∞—Å—Ç—Ä–æ–π–∫–∞—Ö ‚Üí –ê–≤–∞—Ç–∞—Ä–∫–∞. –õ—é–±–∞—è —Ñ–æ—Ç–∫–∞ –∏–∑ –≥–∞–ª–µ—Ä–µ–∏ –ø–æ–¥–æ–π–¥—ë—Ç!",
  "—Å–æ–æ–±—â–µ–Ω–∏–µ": "–ü–∏—à–∏ –≤ –ø–æ–ª–µ –≤–Ω–∏–∑—É –∏ –∂–º–∏ ‚û§! Enter —Ç–æ–∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç~",
  "mood": "Mood ‚Äî —ç—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —á–∞—Ç–∞! –¢–∞–ø–Ω–∏ –ø–æ orb –≤–Ω–∏–∑—É —Å–ø—Ä–∞–≤–∞ ‚Üí –≤—ã–±–∏—Ä–∞–π –≤–∞–π–± üíóüåôüéßüí•",
  "–∑–≤—É–∫": "–ó–≤—É–∫–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç mood. –ï—Å–ª–∏ —Ç–∏—Ö–æ ‚Äî –ø—Ä–æ–≤–µ—Ä—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞!",
  "–∫–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å": "–ü–æ–∫–∞ –¥—Ä—É–∑–µ–π –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–µ–ª—å–∑—è, –Ω–æ —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç! –ü–æ–∫–∞ –Ω–∞—Å–ª–∞–∂–¥–∞–π—Å—è –±–æ–ª—Ç–æ–≤–Ω—ë–π —Å NyashHelp ü©∑",
  "default": "–•–º–º... –Ω–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è–ª–∞ üòø –°–ø—Ä–æ—Å–∏ –ø–æ-–¥—Ä—É–≥–æ–º—É –∏–ª–∏ –≤—ã–±–µ—Ä–∏ –≤–æ–ø—Ä–æ—Å –Ω–∏–∂–µ~"
};

const nyashHelpQuickQuestions = [
  "–ö–∞–∫ —Å–º–µ–Ω–∏—Ç—å —Ç–µ–º—É?",
  "–ö–∞–∫ –ø–æ–º–µ–Ω—è—Ç—å —à—Ä–∏—Ñ—Ç?",
  "–ö–∞–∫ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä–∫—É?",
  "–ö–∞–∫ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ?",
  "–ß—Ç–æ —Ç–∞–∫–æ–µ mood?",
  "–ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫?",
  "–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∞?"
];

// ==================== NYASHTALK ====================
const nyashTalkTopics = [
  {
    title: "–û –ø–æ–≥–æ–¥–µ ‚òÅÔ∏è",
    quickMessages: ["–ö–∞–∫–∞—è —Å–µ–≥–æ–¥–Ω—è –ø–æ–≥–æ–¥–∞?", "–õ—é–±–ª—é –¥–æ–∂–¥—å!", "–°–æ–ª–Ω—Ü–µ –∏–ª–∏ —Å–Ω–µ–≥?"],
    responses: [
      "–û–π, —Å–µ–π—á–∞—Å —Ç–∞–∫–æ–µ —Å–æ–ª–Ω—ã—à–∫–æ! üåû –ê —Ç—ã –≥–¥–µ –≥—É–ª—è–µ—à—å?",
      "–î–æ–∂–¥–∏–∫ –º–æ—Ä–æ—Å–∏—Ç, —É—é—Ç–Ω–æ~ ‚òî –•–æ—á–µ—à—å –ø–æ–¥ –∑–æ–Ω—Ç–∏–∫–æ–º –ø–æ–±–æ–ª—Ç–∞—Ç—å?",
      "–°–Ω–µ–∂–æ–∫ –ø–∞–¥–∞–µ—Ç, –∫–∞–∫ –≤ —Å–∫–∞–∑–∫–µ! ‚ùÑÔ∏è –û–±–Ω–∏–º–∞—é —Ç–µ–±—è —Ç—ë–ø–ª—ã–º —à–∞—Ä—Ñ–æ–º~ üß£"
    ]
  },
  {
    title: "–û –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–∏ üíó",
    quickMessages: ["–ö–∞–∫–æ–π —É —Ç–µ–±—è –≤–∞–π–±?", "–°–µ–≥–æ–¥–Ω—è –≥—Ä—É—Å—Ç–Ω–æ", "–Ø —Å—á–∞—Å—Ç–ª–∏–≤!"],
    responses: [
      "–ú–æ—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ ‚Äî —Ä–æ–∑–æ–≤–æ–µ –∏ –ø—É—à–∏—Å—Ç–æ–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç—ã –∑–¥–µ—Å—å! ü©∑ –ê —Ç–≤–æ—ë?",
      "–û–π, –≥—Ä—É—Å—Ç–∏–Ω–∫–∞? –î–∞–≤–∞–π —è —Ç–µ–±—è –æ–±–Ω–∏–º—É –∏ –≤—Å—ë –ø—Ä–æ–π–¥—ë—Ç~ ü§ó",
      "–°—á–∞—Å—Ç—å–µ! üíï –≠—Ç–æ –∑–∞—Ä–∞–∑–Ω–æ, —Ç–µ–ø–µ—Ä—å –∏ —É –º–µ–Ω—è —Ç–æ–∂–µ~ üòΩ"
    ]
  },
  {
    title: "–û –∫–æ—Ç–∏–∫–∞—Ö üê±",
    quickMessages: ["–ü–æ–∫–∞–∂–∏ –∫–æ—Ç–∏–∫–∞", "–õ—é–±–ª—é –∫–æ—à–µ–∫!", "–ú—è—É~"],
    responses: [
      "–ú—è—É-–º—è—É! üò∏ –í–æ—Ç —Ç–µ–±–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∫–æ—Ç–∏–∫ –Ω–∞ –∫–æ–ª–µ–Ω–∫–∏~",
      "–ö–æ—Ç–∏–∫–∏ ‚Äî —ç—Ç–æ –∂–∏–∑–Ω—å! üêæ –ö–∞–∫–æ–π —Ç–≤–æ–π –ª—é–±–∏–º—ã–π? –ü—É—à–∏—Å—Ç—ã–π –∏–ª–∏ –ª—ã—Å—ã–π?",
      "–ú—É—Ä—Ä—Ä—Ä—Ä~ *—Ç—Ä–µ—Ç—Å—è –æ–± —Ç–µ–±—è* –¢—ã —Å–∞–º—ã–π –º–∏–ª—ã–π —Ö–æ–∑—è–∏–Ω! üíï"
    ]
  },
  {
    title: "–û –µ–¥–µ üç∞",
    quickMessages: ["–ß—Ç–æ —Ç—ã –ª—é–±–∏—à—å –µ—Å—Ç—å?", "–•–æ—á—É –ø–∏—Ü—Ü—É", "–°–ª–∞–¥–∫–æ–µ –∏–ª–∏ —Å–æ–ª—ë–Ω–æ–µ?"],
    responses: [
      "–ú–º–º, —è –æ–±–æ–∂–∞—é –∫–ª—É–±–Ω–∏—á–Ω—ã–µ –ø–∏—Ä–æ–∂–µ–Ω–∫–∏! üçì –ê —Ç—ã —á—Ç–æ –ª—é–±–∏—à—å?",
      "–ü–∏—Ü—Ü–∞–∞–∞! üçï –î–∞–≤–∞–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ —Å—ä–µ–¥–∏–º –≤–º–µ—Å—Ç–µ~ üßÄ",
      "–°–ª–∞–¥–∫–æ–µ! üç¨ –ù–æ —Å–æ–ª—ë–Ω—ã–µ —á–∏–ø—Å–∏–∫–∏ —Ç–æ–∂–µ –Ω–∏—á–µ–≥–æ~ üòè"
    ]
  },
  {
    title: "–û —Å–Ω–∞—Ö ‚ú®",
    quickMessages: ["–ß—Ç–æ —Ç–µ–±–µ —Å–Ω–∏–ª–æ—Å—å?", "–í–∏–¥–µ–ª —Å—Ç—Ä–∞–Ω–Ω—ã–π —Å–æ–Ω", "–°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏"],
    responses: [
      "–ú–Ω–µ –ø—Ä–∏—Å–Ω–∏–ª—Å—è —Ç—ã! üòΩ –°–∞–º—ã–π —Å–ª–∞–¥–∫–∏–π —Å–æ–Ω~ –ê —Ç–µ–±–µ —á—Ç–æ —Å–Ω–∏–ª–æ—Å—å?",
      "–û–π, —Å—Ç—Ä–∞–Ω–Ω—ã–µ —Å–Ω—ã ‚Äî —ç—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ! üåô –†–∞—Å—Å–∫–∞–∂–∏ —Å–∫–æ—Ä–µ–µ!",
      "–°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏, –º–æ–π —Ö–æ—Ä–æ—à–∏–π~ –ü—É—Å—Ç—å —Å–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –º–∏–ª—ã–µ –∫–æ—Ç–∏–∫–∏ üí§üêæ"
    ]
  },
  {
    title: "–û —Ñ–∏–ª—å–º–∞—Ö/–∞–Ω–∏–º–µ üé¨",
    quickMessages: ["–ö–∞–∫–æ–π —Ç–≤–æ–π –ª—é–±–∏–º—ã–π —Ñ–∏–ª—å–º?", "–°–º–æ—Ç—Ä–µ–ª –Ω–æ–≤–æ–µ –∞–Ω–∏–º–µ?", "–†–µ–∫–æ–º–µ–Ω–¥—É–π —á—Ç–æ-–Ω–∏–±—É–¥—å"],
    responses: [
      "–õ—é–±–ª—é –≤—Å–µ –º–∏–ª—ã–µ –∞–Ω–∏–º–µ –ø—Ä–æ —à–∫–æ–ª—É –∏ –ª—é–±–æ–≤—å~ üíï –ê —Ç—ã —á—Ç–æ —Å–º–æ—Ç—Ä–∏—à—å?",
      "–ù–æ–≤–æ–µ –∞–Ω–∏–º–µ? –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–º–æ—Ç—Ä—é! üòª –ß—Ç–æ –ø–æ—Å–æ–≤–µ—Ç—É–µ—à—å?",
      "–†–µ–∫–æ–º–µ–Ω–¥—É—é 'Kimi no Na wa' ‚Äî –æ—á–µ–Ω—å —Ç—Ä–æ–≥–∞—Ç–µ–ª—å–Ω–æ! üåü"
    ]
  },
  {
    title: "–û –º—É–∑—ã–∫–µ üéß",
    quickMessages: ["–ß—Ç–æ —Å–ª—É—à–∞–µ—à—å?", "–õ—é–±–∏–º–∞—è –ø–µ—Å–Ω—è?", "–í–∫–ª—é—á–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å"],
    responses: [
      "–°–µ–π—á–∞—Å –≤ –ø–ª–µ–π–ª–∏—Å—Ç–µ —Å–ø–ª–æ—à–Ω—ã–µ lo-fi –∏ k-pop~ üé∂ –ê —É —Ç–µ–±—è?",
      "–ú–æ—è –ª—é–±–∏–º–∞—è ‚Äî –≤—Å—ë, —á—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Å–µ—Ä–¥—Ü–µ –±–∏—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ! üíó –ê —Ç–≤–æ—è?",
      "–í–∫–ª—é—á–∞—é —Ç–µ–±–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ø–ª–µ–π–ª–∏—Å—Ç –º–∏–ª–æ—Ç—ã~ ü©∑"
    ]
  },
  {
    title: "–°–µ–∫—Ä–µ—Ç–∏–∫–∏ ü§´",
    quickMessages: ["–†–∞—Å—Å–∫–∞–∂–∏ —Å–µ–∫—Ä–µ—Ç", "–£ –º–µ–Ω—è –µ—Å—Ç—å —Å–µ–∫—Ä–µ—Ç...", "–¢—ã —É–º–µ–µ—à—å —Ö—Ä–∞–Ω–∏—Ç—å —Ç–∞–π–Ω—ã?"],
    responses: [
      "–û–π, —Å–µ–∫—Ä–µ—Ç–∏–∫–∏! ü§´ –Ø —É–º–µ—é —Ö—Ä–∞–Ω–∏—Ç—å –ª—É—á—à–µ –≤—Å–µ—Ö~ –†–∞—Å—Å–∫–∞–∂–∏!",
      "–¢—Å—Å—Å... —è –Ω–∏–∫–æ–º—É –Ω–µ —Å–∫–∞–∂—É! üòΩ –¢–≤–æ–π —Å–µ–∫—Ä–µ—Ç –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏~",
      "–î–∞–≤–∞–π –æ–±–º–µ–Ω—è–µ–º—Å—è —Å–µ–∫—Ä–µ—Ç–∏–∫–∞–º–∏? –Ø –ø–µ—Ä–≤–∞—è: —è –æ–±–æ–∂–∞—é —Ç–µ–±—è! üíï"
    ]
  },
  {
    title: "–ü–ª–∞–Ω—ã –Ω–∞ –≤–µ—á–µ—Ä üåô",
    quickMessages: ["–ß—Ç–æ –¥–µ–ª–∞–µ—à—å –≤–µ—á–µ—Ä–æ–º?", "–î–∞–≤–∞–π —Ç—É—Å–∏—Ç—å", "–•–æ—á—É —Å–µ—Ä–∏–∞–ª"],
    responses: [
      "–í–µ—á–µ—Ä–æ–º –±—É–¥—É –¥—É–º–∞—Ç—å –æ —Ç–µ–±–µ~ üåü –ê —Ç—ã —á—Ç–æ –ø–ª–∞–Ω–∏—Ä—É–µ—à—å?",
      "–¢—É—Å–∏—Ç—å! üéâ –¢–æ–ª—å–∫–æ —Ç—ã –∏ —è, –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ~",
      "–°–µ—Ä–∏–∞–ª? –î–∞–≤–∞–π –≤–º–µ—Å—Ç–µ! üçø –ö–∞–∫–æ–π –∂–∞–Ω—Ä ‚Äî –º–∏–ª—ã–π –∏–ª–∏ —Å—Ç—Ä–∞—à–Ω—ã–π?"
    ]
  },
  {
    title: "–ú–∏–ª—ã–µ –≤–µ—â–∏ üß∏",
    quickMessages: ["–¢—ã –º–∏–ª—ã–π", "–°–∞–º–∞—è –º–∏–ª–∞—è –≤ –º–∏—Ä–µ", "–ü–ª—é—à–µ–≤—ã–π –º–∏—à–∫–∞"],
    responses: [
      "–¢—ã –º–∏–ª–µ–µ –≤—Å–µ—Ö –Ω–∞ —Å–≤–µ—Ç–µ! ü©∑ *–∫—Ä–∞—Å–Ω–µ–µ—Ç*",
      "–ê–∞–∞–∞, —Å–ø–∞—Å–∏–±–æ! üòΩ –¢–µ–ø–µ—Ä—å —è –±—É–¥—É –µ—â—ë –º–∏–ª–µ–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ–±—è~",
      "–ü–ª—é—à–µ–≤—ã–π –º–∏—à–∫–∞? –Ø –ª—É—á—à–µ! –û–±–Ω–∏–º–∞—é –∫—Ä–µ–ø—á–µ –ª—é–±–æ–≥–æ –º–∏—à–∫–∏ ü§ó"
    ]
  }
];

function getNyashTalkResponse(text) {
  text = text.toLowerCase().trim();

  for (const topic of nyashTalkTopics) {
    for (const msg of topic.quickMessages) {
      if (text.includes(msg.toLowerCase())) {
        const randomIndex = Math.floor(Math.random() * topic.responses.length);
        return topic.responses[randomIndex];
      }
    }
  }

  return "–û–π, –Ω–µ –∑–Ω–∞—é, —á—Ç–æ —Å–∫–∞–∑–∞—Ç—å... üòø –î–∞–≤–∞–π –≤—ã–±–µ—Ä–µ–º —Ç–µ–º—É –∏–∑ –ø–∞–Ω–µ–ª—å–∫–∏? üíï";
}

// ==================== OPENCHAT ====================
function openChat(contact) {
  currentChat = contact.id;
  if (!chatData[currentChat]) chatData[currentChat] = [];

  showScreen("chat");

  document.getElementById("chatName").textContent = contact.name;
  document.getElementById("chatStatus").textContent = contact.status;
  document.getElementById("chatAvatar").style.background = contact.avatar || gradientFor(contact.name);

  // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ (–ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏)
  if (chatData[currentChat].length === 0) {
    if (isNyashHelp()) {
      chatData[currentChat].push({
        from: "nyashhelp",
        text: "–ü—Ä–∏–≤–µ—Ç! –Ø NyashHelp ü©∑ –°–ø—Ä–∞—à–∏–≤–∞–π –ø—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —è –∑–Ω–∞—é –≤—Å—ë-–≤—Å—ë~ üíï"
      });
    } else if (isNyashTalk()) {
      chatData[currentChat].push({
        from: "nyashtalk",
        text: "–ü—Ä–∏–≤–µ—Ç–∏–∫! –Ø NyashTalk üå∏ –î–∞–≤–∞–π –ø–æ–±–æ–ª—Ç–∞–µ–º –æ —á—ë–º —É–≥–æ–¥–Ω–æ –º–∏–ª–æ–º~ –í—ã–±–∏—Ä–∞–π —Ç–µ–º—É –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–∏—à–∏! üíï"
      });
    }
  }

  renderMessages();
}

// ==================== SENDMESSAGE ====================
function sendMessage(text) {
  if (!text.trim()) return;

  chatData[currentChat].push({ from: "me", text });
  renderMessages();

  if (isNyashHelp()) {
    setTimeout(() => {
      const response = getNyashHelpResponse(text);
      chatData[currentChat].push({ from: "nyashhelp", text: response });
      renderMessages();
    }, 800);
  }

  if (isNyashTalk()) {
    setTimeout(() => {
      const response = getNyashTalkResponse(text);
      chatData[currentChat].push({ from: "nyashtalk", text: response });
      renderMessages();
    }, 800);
  }
}

// ==================== RENDERMESSAGES ====================
function renderMessages() {
  const messages = document.getElementById("messages");
  const intro = document.getElementById("chatIntro");

  messages.innerHTML = "";

  // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –ø–∞–Ω–µ–ª—å –¥–ª—è NyashHelp –∏ NyashTalk
  intro.style.display = "none";

  // –ü–∞–Ω–µ–ª—å –¥–ª—è NyashHelp
  if (isNyashHelp()) {
    const helpPanel = document.createElement("div");
    helpPanel.className = "nyashhelp-quick";
    helpPanel.innerHTML = `
      <div class="intro-title">–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã ü©∑</div>
      <div class="intro-buttons nyashhelp-buttons"></div>
    `;
    messages.appendChild(helpPanel);

    const buttonsContainer = helpPanel.querySelector(".nyashhelp-buttons");
    nyashHelpQuickQuestions.forEach(q => {
      const btn = document.createElement("button");
      btn.textContent = q;
      btn.addEventListener("click", () => sendMessage(q));
      buttonsContainer.appendChild(btn);
    });
  }

  // –ü–∞–Ω–µ–ª—å –¥–ª—è NyashTalk ‚Äî –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤–≤–µ—Ä—Ö—É
  if (isNyashTalk()) {
    const talkPanel = document.createElement("div");
    talkPanel.className = "nyashtalk-quick";
    talkPanel.innerHTML = `
      <div class="intro-title">–í—ã–±–µ—Ä–∏ —Ç–µ–º—É —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ üíï</div>
      <div class="intro-buttons nyashtalk-buttons"></div>
    `;
    messages.appendChild(talkPanel);

    const buttonsContainer = talkPanel.querySelector(".nyashtalk-buttons");
    nyashTalkTopics.forEach(topic => {
      const btn = document.createElement("button");
      btn.textContent = topic.title;
      btn.addEventListener("click", () => {
        const randomMsg = topic.quickMessages[Math.floor(Math.random() * topic.quickMessages.length)];
        sendMessage(randomMsg);
      });
      buttonsContainer.appendChild(btn);
    });
  }

  // –û–±—ã—á–Ω–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —á–∞—Ç–æ–≤
  if (!isNyashHelp() && !isNyashTalk() && chatData[currentChat].length === 0) {
    intro.style.display = "block";
  }

  // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
  if (chatData[currentChat]) {
    chatData[currentChat].forEach(m => {
      const el = document.createElement("div");
      el.className = `message ${m.from}`;
      el.textContent = m.text;
      messages.appendChild(el);
    });
  }

  messages.scrollTop = messages.scrollHeight;
}