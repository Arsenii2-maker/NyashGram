<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>NyashGram</title>

<style>
:root {
  --accent: #ffcc33;
  --bg: #0f0f12;
  --panel: #18181d;
  --text: #ffffff;
}

* {
  box-sizing: border-box;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
}

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  overflow: hidden;
}

.hidden { display: none; }

button {
  background: var(--accent);
  border: none;
  border-radius: 12px;
  padding: 10px 14px;
  font-weight: 600;
  cursor: pointer;
  transition: transform .15s;
}
button:active { transform: scale(.96); }

/* –≠–ö–†–ê–ù–´ */
.screen {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  animation: fade .25s ease;
}

@keyframes fade {
  from { opacity: 0; transform: scale(.98); }
  to { opacity: 1; transform: scale(1); }
}

/* –°–¢–ê–†–¢ */
#start {
  justify-content: center;
  align-items: center;
  gap: 20px;
}

input {
  background: #222;
  border: none;
  color: white;
  padding: 12px;
  border-radius: 10px;
  width: 220px;
}

/* –ß–ê–¢–´ */
#chats {
  background: var(--panel);
}

.header {
  padding: 14px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #111;
}

.chat-list {
  flex: 1;
  overflow-y: auto;
}

.chat {
  padding: 14px;
  border-bottom: 1px solid #222;
  cursor: pointer;
}
.chat:hover { background: #222; }

/* –ß–ê–¢ */
#chat {
  background-size: cover;
  background-position: center;
}

.messages {
  flex: 1;
  padding: 10px;
  overflow-y: auto;
}

.msg {
  max-width: 70%;
  margin-bottom: 8px;
  padding: 8px 12px;
  border-radius: 14px;
  animation: pop .2s ease;
}

@keyframes pop {
  from { transform: scale(.9); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

.me {
  background: var(--accent);
  color: black;
  margin-left: auto;
}

.other {
  background: #2a2a2f;
}

.input-bar {
  display: flex;
  gap: 6px;
  padding: 10px;
  background: #111;
}

.input-bar input {
  flex: 1;
}

/* –ü–†–û–§–ò–õ–¨ */
#profile {
  padding: 16px;
  gap: 14px;
}

.avatar {
  width: 96px;
  height: 96px;
  border-radius: 50%;
  background: #333;
  overflow: hidden;
}

.avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* –ù–ê–°–¢–†–û–ô–ö–ò */
.color-picker {
  display: flex;
  gap: 10px;
}

.color {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  cursor: pointer;
}
</style>
</head>

<body>

<!-- –°–¢–ê–†–¢ -->
<div id="start" class="screen">
  <h2>NyashGram</h2>
  <input id="nameInput" placeholder="–¢–≤–æ—ë –∏–º—è" />
  <button onclick="enter()">–í–æ–π—Ç–∏</button>
</div>

<!-- –ß–ê–¢–´ -->
<div id="chats" class="screen hidden">
  <div class="header">
    <b id="userName"></b>
    <button onclick="openProfile()">–ü—Ä–æ—Ñ–∏–ª—å</button>
  </div>
  <div class="chat-list">
    <div class="chat" onclick="openChat()">bestie üí¨</div>
  </div>
</div>

<!-- –ß–ê–¢ -->
<div id="chat" class="screen hidden">
  <div class="header">
    <button onclick="backToChats()">‚Üê</button>
    <b>bestie</b>
  </div>

  <div class="messages" id="messages"></div>

  <div class="input-bar">
    <button onclick="sendImage()">üì∑</button>
    <button id="recBtn">üéô</button>
    <input id="msgInput" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ..." />
    <button onclick="sendMsg()">‚û§</button>
  </div>
</div>

<!-- –ü–†–û–§–ò–õ–¨ -->
<div id="profile" class="screen hidden">
  <div class="header">
    <button onclick="backToChats()">‚Üê</button>
    <b>–ü—Ä–æ—Ñ–∏–ª—å</b>
  </div>

  <div class="avatar">
    <img id="avatarImg" />
  </div>
  <input type="file" accept="image/*" onchange="setAvatar(this)" />

  <button onclick="openSettings()">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
</div>

<!-- –ù–ê–°–¢–†–û–ô–ö–ò -->
<div id="settings" class="screen hidden">
  <div class="header">
    <button onclick="openProfile()">‚Üê</button>
    <b>–ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è</b>
  </div>

  <p>–¶–≤–µ—Ç –∫–Ω–æ–ø–æ–∫</p>
  <div class="color-picker">
    <div class="color" style="background:#ffcc33" onclick="setColor('#ffcc33')"></div>
    <div class="color" style="background:#ff66cc" onclick="setColor('#ff66cc')"></div>
<div class="color" style="background:#66ffcc" onclick="setColor('#66ffcc')"></div>
  </div>

  <p>–û–±–æ–∏ —á–∞—Ç–∞</p>
  <input type="file" accept="image/*" onchange="setWallpaper(this)" />
</div>

<script>
let recorder, chunks = [];

function show(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}

function enter() {
  const name = nameInput.value.trim();
  if (!name) return;
  userName.textContent = name;
  show('chats');
}

function openChat() { show('chat'); }
function backToChats() { show('chats'); }
function openProfile() { show('profile'); }
function openSettings() { show('settings'); }

function sendMsg() {
  const text = msgInput.value;
  if (!text) return;
  addMsg(text, 'me');
  msgInput.value = '';
}

function addMsg(content, cls) {
  const div = document.createElement('div');
  div.className = 'msg ' + cls;
  div.innerHTML = content;
  messages.appendChild(div);
  messages.scrollTop = messages.scrollHeight;
}

function sendImage() {
  const i = document.createElement('input');
  i.type = 'file';
  i.accept = 'image/*';
  i.onchange = () => {
    const img = URL.createObjectURL(i.files[0]);
    addMsg(`<img src="${img}" style="max-width:100%;border-radius:10px">`, 'me');
  };
  i.click();
}

/* –ì–û–õ–û–°–û–í–´–ï */
recBtn.onclick = async () => {
  if (!recorder) {
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    recorder = new MediaRecorder(stream);
    recorder.ondataavailable = e => chunks.push(e.data);
    recorder.onstop = () => {
      const blob = new Blob(chunks, { type: 'audio/webm' });
      chunks = [];
      const url = URL.createObjectURL(blob);
      addMsg(`<audio controls src="${url}"></audio>`, 'me');
    };
    recorder.start();
    recBtn.textContent = '‚èπ';
  } else {
    recorder.stop();
    recorder = null;
    recBtn.textContent = 'üéô';
  }
};

function setAvatar(input) {
  avatarImg.src = URL.createObjectURL(input.files[0]);
}

function setColor(c) {
  document.documentElement.style.setProperty('--accent', c);
}

function setWallpaper(input) {
  const url = URL.createObjectURL(input.files[0]);
  document.getElementById('chat').style.backgroundImage = url(${url});
}
</script>

</body>
</html>
