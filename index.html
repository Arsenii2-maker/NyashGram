<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>NyashGram</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;500;700&family=Fredoka:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>

<div id="app">

  <!-- –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑: —ç–∫—Ä–∞–Ω –Ω–æ–º–µ—Ä–∞ -->
  <section id="phoneScreen" class="screen">
    <div class="container">
      <h1>NyashGram ‚ô•</h1>
      <p>–í—Ö–æ–¥ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞</p>

      <div class="phone-input">
        <select id="countryCode">
          <option value="+7">+7 –†–æ—Å—Å–∏—è</option>
          <option value="+380">+380 –£–∫—Ä–∞–∏–Ω–∞</option>
        </select>
        <input type="tel" id="phoneNumber" placeholder="999 999 99 99" />
      </div>

      <div id="phoneError" style="color:#e74c3c; font-size:14px; margin:8px 0;"></div>
      <button id="sendBtn" disabled>–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥</button>
    </div>
  </section>

  <!-- –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑: —ç–∫—Ä–∞–Ω –∫–æ–¥–∞ -->
  <section id="codeScreen" class="screen">
    <div class="container">
      <h1>NyashGram ‚ô•</h1>
      <p>–í–≤–µ–¥–∏ –∫–æ–¥</p>

      <input type="text" id="codeInput" placeholder="------" maxlength="6" />

      <div id="codeError" style="color:#e74c3c; font-size:14px; margin-top:12px;"></div>
      <button id="verifyBtn" disabled>–í–æ–π—Ç–∏</button>
    </div>
  </section>

  <!-- –°—Ç–∞—Ä—ã–π —ç–∫—Ä–∞–Ω –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ -->
  <section id="contactsScreen" class="screen">
    <header class="top-bar">
      <button id="settingsBtn">‚öôÔ∏è</button>
      <div class="top-title">–ö–æ–Ω—Ç–∞–∫—Ç—ã</div>
    </header>
    <div id="contactsList"></div>
  </section>

  <!-- –°—Ç–∞—Ä—ã–π —á–∞—Ç -->
  <section id="chatScreen" class="screen">
    <header class="top-bar">
      <button id="backBtn">‚Üê</button>
      <div class="chat-header">
        <div id="chatAvatar" class="avatar"></div>
        <div>
          <div id="chatName"></div>
          <div id="chatStatus" class="status"></div>
        </div>
      </div>
    </header>

    <div id="messages"></div>

    <div class="input-bar">
      <input id="messageInput" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ...">
      <button id="sendBtn">‚û§</button>
    </div>
  </section>

  <!-- –°—Ç–∞—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
  <section id="settingsScreen" class="screen">
    <header class="top-bar">
      <button id="settingsBackBtn">‚Üê</button>
      <div class="top-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
    </header>

    <div style="padding:16px; display:flex; flex-direction:column; gap:16px">
      <label>
        –ù–∏–∫–Ω–µ–π–º
        <input id="settingsName" placeholder="–¢–≤–æ–π –Ω–∏–∫">
      </label>

      <label>
        –¢–µ–º–∞
        <select id="themeSelect">
          <option value="pastel-pink">Pastel Pink ü©∑</option>
          <option value="milk-rose">Milk Rose üå∏</option>
          <option value="night-blue">Night Blue üåô</option>
        </select>
      </label>

      <label>
        –®—Ä–∏—Ñ—Ç
        <select id="fontSelect">
          <option value="system">System</option>
          <option value="rounded">Rounded</option>
          <option value="cozy">Cozy</option>
        </select>
      </label>

      <button id="saveSettingsBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </section>

</div>

<script>
// –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–æ–≤
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ —É–∂–µ –≤—Ö–æ–¥
if (localStorage.getItem("nyashgram_entered") === "true") {
  showScreen("contactsScreen");
} else {
  showScreen("phoneScreen");
}

// –≠–∫—Ä–∞–Ω –Ω–æ–º–µ—Ä–∞
const phoneInput = document.getElementById("phoneNumber");
const sendBtn = document.getElementById("sendBtn");
const phoneError = document.getElementById("phoneError");

function checkPhone() {
  const phone = phoneInput.value.trim().replace(/\D/g, "");
  if (phone.length >= 9) {
    sendBtn.classList.add("active");
    sendBtn.disabled = false;
    phoneError.textContent = "";
  } else {
    sendBtn.classList.remove("active");
    sendBtn.disabled = true;
    phoneError.textContent = phone.length === 0 ? "" : "–ù–æ–º–µ—Ä –∫–æ—Ä–æ—Ç–∫–∏–π";
  }
}

phoneInput.addEventListener("input", checkPhone);
checkPhone();

let generatedCode = "";
function generateCode() {
  generatedCode = Math.floor(100000 + Math.random() * 900000).toString();
  document.getElementById("codeInput").placeholder = generatedCode.split("").join(" ");
}

sendBtn.addEventListener("click", () => {
  generateCode();
  showScreen("codeScreen");
});

// –≠–∫—Ä–∞–Ω –∫–æ–¥–∞
const codeInput = document.getElementById("codeInput");
const verifyBtn = document.getElementById("verifyBtn");
const codeError = document.getElementById("codeError");

codeInput.addEventListener("input", () => {
  const entered = codeInput.value.trim();
  if (entered.length === 6) {
    if (entered === generatedCode) {
      codeError.textContent = "";
      verifyBtn.classList.add("active");
      verifyBtn.disabled = false;
    } else {
      codeError.textContent = "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥";
      verifyBtn.classList.remove("active");
      verifyBtn.disabled = true;
    }
  } else {
    codeError.textContent = "";
    verifyBtn.classList.remove("active");
    verifyBtn.disabled = true;
  }
});

verifyBtn.addEventListener("click", () => {
  if (verifyBtn.disabled) return;
  localStorage.setItem("nyashgram_entered", "true");
  showScreen("contactsScreen");
});

// –ù–∞—Å—Ç—Ä–æ–π–∫–∏
document.getElementById("settingsBtn").onclick = () => showScreen("settingsScreen");
document.getElementById("settingsBackBtn").onclick = () => showScreen("contactsScreen");
document.getElementById("saveSettingsBtn").onclick = () => {
  alert("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!");
  showScreen("contactsScreen");
};
</script>

<script src="contacts.js"></script>
<script src="chat.js"></script>
</body>
</html>